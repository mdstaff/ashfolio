🧪 Running standard test suite...
     warning: redefining module YahooFinanceMock (current version loaded from _build/test/lib/ashfolio/ebin/Elixir.YahooFinanceMock.beam)
     │
 491 │     Module.create(name, [info | body], Macro.Env.location(__ENV__))
     │     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     │
     └─ deps/mox/lib/mox.ex:491: YahooFinanceMock (module)

✅ Test user validated: Test User
✅ Test account validated: Default Test Account
✅ Test symbols validated: 4 common symbols found
🛡️  Global test data validation: ALL CHECKS PASSED
Running ExUnit with seed: 544498, max_cases: 16
Excluding tags: [:performance, :slow, :integration]

    warning: unused import Phoenix.HTML.Form
    │
 49 │     import Phoenix.HTML.Form
    │     ~
    │
    └─ test/ashfolio_web/components/symbol_autocomplete_ui_test.exs:49:5

....     warning: variable "user_category" is unused (if the variable is not meant to be used, prefix it with an underscore)
     │
 302 │     test "displays category transaction count", %{conn: conn, user_category: user_category} do
     │                                                                              ~~~~~~~~~~~~~
     │
     └─ test/ashfolio_web/live/category_live/index_test.exs:302:78: AshfolioWeb.CategoryLive.IndexTest."test CategoryLive.Index additional tests displays category transaction count"/1

    warning: unused alias Account
    │
 11 │   alias Ashfolio.Portfolio.{User, Account, Symbol, Transaction}
    │   ~
    │
    └─ test/ashfolio/market_data/price_manager_test.exs:11:3

    warning: unused alias User
    │
 11 │   alias Ashfolio.Portfolio.{User, Account, Symbol, Transaction}
    │   ~
    │
    └─ test/ashfolio/market_data/price_manager_test.exs:11:3

    warning: unused alias User
    │
 10 │   alias Ashfolio.Portfolio.{Transaction, Account, Symbol, User}
    │   ~
    │
    └─ test/ashfolio_web/live/transaction_live_filtering_test.exs:10:3

.....    warning: variable "checking_account" is unused (if the variable is not meant to be used, prefix it with an underscore)
    │
 23 │       {:ok, checking_account} =
    │             ~~~~~~~~~~~~~~~~
    │
    └─ test/ashfolio/financial_management/net_worth_calculator_test.exs:23:13: Ashfolio.FinancialManagement.NetWorthCalculatorTest."test calculate_net_worth/1 calculates net worth with investment and cash accounts"/1

    warning: variable "savings_account" is unused (if the variable is not meant to be used, prefix it with an underscore)
    │
 32 │       {:ok, savings_account} =
    │             ~~~~~~~~~~~~~~~
    │
    └─ test/ashfolio/financial_management/net_worth_calculator_test.exs:32:13: Ashfolio.FinancialManagement.NetWorthCalculatorTest."test calculate_net_worth/1 calculates net worth with investment and cash accounts"/1

...     warning: variable "view" is unused (if the variable is not meant to be used, prefix it with an underscore)
     │
 182 │       {:ok, view, _html} = live(conn, ~p"/accounts/#{cash_account.id}")
     │             ~~~~
     │
     └─ test/ashfolio_web/live/account_live/show_balance_update_test.exs:182:13: AshfolioWeb.AccountLive.ShowBalanceUpdateTest."test AccountLive.Show Balance Update Integration shows real-time balance updates via PubSub"/1

..............    warning: unused alias Symbol
    │
 10 │   alias Ashfolio.Portfolio.{User, Account, Transaction, Symbol}
    │   ~
    │
    └─ test/ashfolio_web/live/account_live/show_test.exs:10:3

    warning: unused alias User
    │
 10 │   alias Ashfolio.Portfolio.{User, Account, Transaction, Symbol}
    │   ~
    │
    └─ test/ashfolio_web/live/account_live/show_test.exs:10:3

..    warning: unused import Ashfolio.SQLiteHelpers
    │
  9 │   import Ashfolio.SQLiteHelpers
    │   ~
    │
    └─ test/ashfolio/portfolio/symbol_test.exs:9:3

........     warning: variable "transactions_per_account" is unused (if the variable is not meant to be used, prefix it with an underscore)
     │
 268 │   defp create_performance_test_data(user_id, account_count, transactions_per_account) do
     │                                                             ~~~~~~~~~~~~~~~~~~~~~~~~
     │
     └─ test/performance/net_worth_optimization_comparison_test.exs:268:61: Ashfolio.Performance.NetWorthOptimizationComparisonTest.create_performance_test_data/3

     warning: variable "user" is unused (if the variable is not meant to be used, prefix it with an underscore)
     │
 195 │     test "burst updates handle efficiently", %{user: user} do
     │                                                      ~~~~
     │
     └─ test/performance/liveview_simple_performance_test.exs:195:54: Ashfolio.Performance.LiveViewSimplePerformanceTest."test Update Cycle Performance burst updates handle efficiently"/1

    warning: default values for the optional arguments in test_changeset/1 are never used
    │
  8 │   defp test_changeset(attrs \\ %{}) do
    │        ~
    │
    └─ test/ashfolio/validation_test.exs:8:8: Ashfolio.ValidationTest (module)

..    warning: unused alias Symbol
    │
  5 │   alias Ashfolio.Portfolio.{User, Account, Symbol, Transaction}
    │   ~
    │
    └─ test/ashfolio/financial_management/net_worth_calculator_test.exs:5:3

    warning: unused alias User
    │
  5 │   alias Ashfolio.Portfolio.{User, Account, Symbol, Transaction}
    │   ~
    │
    └─ test/ashfolio/financial_management/net_worth_calculator_test.exs:5:3

...........................    warning: variable "config_ast" is unused (if the variable is not meant to be used, prefix it with an underscore)
    │
 26 │       config_ast = quote do
    │       ~~~~~~~~~~
    │
    └─ test/ashfolio_web/layout_configuration_test.exs:26:7: AshfolioWeb.LayoutConfigurationTest."test layout configuration regression test LiveView should use :app layout, not :root layout"/1

...........    warning: variable "index_live" is unused (if the variable is not meant to be used, prefix it with an underscore)
    │
 86 │       {:ok, index_live, _html} = live(conn, ~p"/transactions")
    │             ~~~~~~~~~~
    │
    └─ test/ashfolio_web/live/transaction_live/form_component_test.exs:86:13: AshfolioWeb.TransactionLive.FormComponentTest."test new transaction form hides category dropdown when no categories exist"/1

.........................    warning: unused alias User
    │
  8 │   alias Ashfolio.Portfolio.User
    │   ~
    │
    └─ test/ashfolio/financial_management/category_seeder_test.exs:8:3

     warning: variable "transaction" is unused (if the variable is not meant to be used, prefix it with an underscore)
     │
 113 │       transaction = create_transaction(account.id, symbol.id)
     │       ~~~~~~~~~~~
     │
     └─ test/ashfolio/context_test.exs:113:7: Ashfolio.ContextTest."test get_account_with_transactions/2 returns account data with transaction history"/1

............✅ Current configuration is CORRECT: LiveView uses :app layout

To test regression detection:
1. Change ashfolio_web.ex line ~56 to: layout: {AshfolioWeb.Layouts, :root}
2. Run: mix test test/ashfolio_web/layout_*test.exs
3. You should see failures detecting duplicate IDs
4. Change back to: layout: {AshfolioWeb.Layouts, :app}
5. Run tests again - they should pass

This validates the regression tests work correctly.

.Configuration examples:
# ✅ CORRECT - What we have now
use Phoenix.LiveView,
  layout: {AshfolioWeb.Layouts, :app}

# ❌ INCORRECT - What caused the issue
use Phoenix.LiveView,
  layout: {AshfolioWeb.Layouts, :root}

.................................................................     warning: redefining module AshfolioWeb.CategoryLive.FormComponentTest.TestHostLiveView (current version defined in memory)
     │
 502 │     defmodule TestHostLiveView do
     │     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     │
     └─ test/ashfolio_web/live/category_live/form_component_test.exs:502: AshfolioWeb.CategoryLive.FormComponentTest.TestHostLiveView (module)

.     warning: redefining module AshfolioWeb.CategoryLive.FormComponentTest.TestHostLiveView (current version defined in memory)
     │
 502 │     defmodule TestHostLiveView do
     │     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     │
     └─ test/ashfolio_web/live/category_live/form_component_test.exs:502: AshfolioWeb.CategoryLive.FormComponentTest.TestHostLiveView (module)

.     warning: redefining module AshfolioWeb.CategoryLive.FormComponentTest.TestHostLiveView (current version defined in memory)
     │
 502 │     defmodule TestHostLiveView do
     │     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     │
     └─ test/ashfolio_web/live/category_live/form_component_test.exs:502: AshfolioWeb.CategoryLive.FormComponentTest.TestHostLiveView (module)

.     warning: redefining module AshfolioWeb.CategoryLive.FormComponentTest.TestHostLiveView (current version defined in memory)
     │
 502 │     defmodule TestHostLiveView do
     │     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     │
     └─ test/ashfolio_web/live/category_live/form_component_test.exs:502: AshfolioWeb.CategoryLive.FormComponentTest.TestHostLiveView (module)

.     warning: redefining module AshfolioWeb.CategoryLive.FormComponentTest.TestHostLiveView (current version defined in memory)
     │
 502 │     defmodule TestHostLiveView do
     │     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     │
     └─ test/ashfolio_web/live/category_live/form_component_test.exs:502: AshfolioWeb.CategoryLive.FormComponentTest.TestHostLiveView (module)

.     warning: redefining module AshfolioWeb.CategoryLive.FormComponentTest.TestHostLiveView (current version defined in memory)
     │
 502 │     defmodule TestHostLiveView do
     │     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     │
     └─ test/ashfolio_web/live/category_live/form_component_test.exs:502: AshfolioWeb.CategoryLive.FormComponentTest.TestHostLiveView (module)

.     warning: redefining module AshfolioWeb.CategoryLive.FormComponentTest.TestHostLiveView (current version defined in memory)
     │
 502 │     defmodule TestHostLiveView do
     │     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     │
     └─ test/ashfolio_web/live/category_live/form_component_test.exs:502: AshfolioWeb.CategoryLive.FormComponentTest.TestHostLiveView (module)

..     warning: redefining module AshfolioWeb.CategoryLive.FormComponentTest.TestHostLiveView (current version defined in memory)
     │
 502 │     defmodule TestHostLiveView do
     │     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     │
     └─ test/ashfolio_web/live/category_live/form_component_test.exs:502: AshfolioWeb.CategoryLive.FormComponentTest.TestHostLiveView (module)

.     warning: redefining module AshfolioWeb.CategoryLive.FormComponentTest.TestHostLiveView (current version defined in memory)
     │
 502 │     defmodule TestHostLiveView do
     │     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     │
     └─ test/ashfolio_web/live/category_live/form_component_test.exs:502: AshfolioWeb.CategoryLive.FormComponentTest.TestHostLiveView (module)

.     warning: redefining module AshfolioWeb.CategoryLive.FormComponentTest.TestHostLiveView (current version defined in memory)
     │
 502 │     defmodule TestHostLiveView do
     │     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     │
     └─ test/ashfolio_web/live/category_live/form_component_test.exs:502: AshfolioWeb.CategoryLive.FormComponentTest.TestHostLiveView (module)

.     warning: redefining module AshfolioWeb.CategoryLive.FormComponentTest.TestHostLiveView (current version defined in memory)
     │
 502 │     defmodule TestHostLiveView do
     │     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     │
     └─ test/ashfolio_web/live/category_live/form_component_test.exs:502: AshfolioWeb.CategoryLive.FormComponentTest.TestHostLiveView (module)

.     warning: redefining module AshfolioWeb.CategoryLive.FormComponentTest.TestHostLiveView (current version defined in memory)
     │
 502 │     defmodule TestHostLiveView do
     │     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     │
     └─ test/ashfolio_web/live/category_live/form_component_test.exs:502: AshfolioWeb.CategoryLive.FormComponentTest.TestHostLiveView (module)

.     warning: redefining module AshfolioWeb.CategoryLive.FormComponentTest.TestHostLiveView (current version defined in memory)
     │
 502 │     defmodule TestHostLiveView do
     │     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     │
     └─ test/ashfolio_web/live/category_live/form_component_test.exs:502: AshfolioWeb.CategoryLive.FormComponentTest.TestHostLiveView (module)

.........................................................................................     warning: redefining module AshfolioWeb.AccountLive.BalanceUpdateComponentTest.TestHostLiveView (current version defined in memory)
     │
 247 │     defmodule TestHostLiveView do
     │     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     │
     └─ test/ashfolio_web/live/account_live/balance_update_component_test.exs:247: AshfolioWeb.AccountLive.BalanceUpdateComponentTest.TestHostLiveView (module)

.     warning: redefining module AshfolioWeb.AccountLive.BalanceUpdateComponentTest.TestHostLiveView (current version defined in memory)
     │
 247 │     defmodule TestHostLiveView do
     │     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     │
     └─ test/ashfolio_web/live/account_live/balance_update_component_test.exs:247: AshfolioWeb.AccountLive.BalanceUpdateComponentTest.TestHostLiveView (module)

.     warning: redefining module AshfolioWeb.AccountLive.BalanceUpdateComponentTest.TestHostLiveView (current version defined in memory)
     │
 247 │     defmodule TestHostLiveView do
     │     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     │
     └─ test/ashfolio_web/live/account_live/balance_update_component_test.exs:247: AshfolioWeb.AccountLive.BalanceUpdateComponentTest.TestHostLiveView (module)

..     warning: redefining module AshfolioWeb.AccountLive.BalanceUpdateComponentTest.TestHostLiveView (current version defined in memory)
     │
 247 │     defmodule TestHostLiveView do
     │     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     │
     └─ test/ashfolio_web/live/account_live/balance_update_component_test.exs:247: AshfolioWeb.AccountLive.BalanceUpdateComponentTest.TestHostLiveView (module)

.     warning: redefining module AshfolioWeb.AccountLive.BalanceUpdateComponentTest.TestHostLiveView (current version defined in memory)
     │
 247 │     defmodule TestHostLiveView do
     │     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     │
     └─ test/ashfolio_web/live/account_live/balance_update_component_test.exs:247: AshfolioWeb.AccountLive.BalanceUpdateComponentTest.TestHostLiveView (module)

.     warning: redefining module AshfolioWeb.AccountLive.BalanceUpdateComponentTest.TestHostLiveView (current version defined in memory)
     │
 247 │     defmodule TestHostLiveView do
     │     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     │
     └─ test/ashfolio_web/live/account_live/balance_update_component_test.exs:247: AshfolioWeb.AccountLive.BalanceUpdateComponentTest.TestHostLiveView (module)

.     warning: redefining module AshfolioWeb.AccountLive.BalanceUpdateComponentTest.TestHostLiveView (current version defined in memory)
     │
 247 │     defmodule TestHostLiveView do
     │     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     │
     └─ test/ashfolio_web/live/account_live/balance_update_component_test.exs:247: AshfolioWeb.AccountLive.BalanceUpdateComponentTest.TestHostLiveView (module)

.     warning: redefining module AshfolioWeb.AccountLive.BalanceUpdateComponentTest.TestHostLiveView (current version defined in memory)
     │
 247 │     defmodule TestHostLiveView do
     │     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     │
     └─ test/ashfolio_web/live/account_live/balance_update_component_test.exs:247: AshfolioWeb.AccountLive.BalanceUpdateComponentTest.TestHostLiveView (module)

...........................................................................................

  1) test account deletion allows deletion after all transactions are removed (AshfolioWeb.AccountLive.IndexTest)
     test/ashfolio_web/live/account_live/index_test.exs:460
     ** (RuntimeError) Failed to update symbol MSFT price: %Ash.Error.Unknown{bread_crumbs: ["Error returned from: Ashfolio.Portfolio.Symbol.update_price"],  changeset: "#Changeset<>",  errors: [%Ash.Error.Unknown.UnknownError{error: "** (Exqlite.Error) Database busy\nUPDATE \"symbols\" AS s0 SET \"updated_at\" = ?, \"current_price\" = ?, \"price_updated_at\" = ? WHERE (s0.\"id\" = ?) RETURNING \"id\", \"name\", \"symbol\", \"currency\", \"inserted_at\", \"updated_at\", \"current_price\", \"price_updated_at\", \"asset_class\", \"data_source\", \"countries\", \"isin\", \"sectors\"", field: nil, value: nil, splode: Ash.Error, bread_crumbs: ["Error returned from: Ashfolio.Portfolio.Symbol.update_price"], vars: [], path: [], stacktrace: #Splode.Stacktrace<>, class: :unknown}]}
     code: SQLiteHelpers.get_or_create_symbol("MSFT", %{
     stacktrace:
       (ashfolio 0.1.0) test/support/sqlite_helpers.ex:352: Ashfolio.SQLiteHelpers.get_or_create_symbol/2
       test/ashfolio_web/live/account_live/index_test.exs:467: (test)

     The following output was logged:
     16:20:25.654 [error] Exqlite.Connection (#PID<0.353.0>) disconnected: ** (DBConnection.ConnectionError) client #PID<0.5087.0> exited
     
....16:20:25.692 [error] Exqlite.Connection (#PID<0.355.0>) disconnected: ** (DBConnection.ConnectionError) client #PID<0.5154.0> exited
..........................................................................................................................................................................................................................................................................
Finished in 11.2 seconds (1.2s async, 10.0s sync)
907 tests, 1 failure, 256 excluded
error: Recipe `test` failed with exit code 2
